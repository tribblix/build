diff -wpruN '--exclude=*.orig' a~/CPP/7zip/Archive/7z/7zIn.cpp a/CPP/7zip/Archive/7z/7zIn.cpp
--- a~/CPP/7zip/Archive/7z/7zIn.cpp	1970-01-01 00:00:00
+++ a/CPP/7zip/Archive/7z/7zIn.cpp	1970-01-01 00:00:00
@@ -1097,6 +1097,7 @@ HRESULT CInArchive::ReadAndDecodePackedS
       if (CrcCalc(data, unpackSize) != folders.FolderCRCs.Vals[i])
         ThrowIncorrect();
   }
+  if (folders.PackPositions)
   HeadersSize += folders.PackPositions[folders.NumPackStreams];
   return S_OK;
 }
